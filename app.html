<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenTV Player</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-logo">
                <img src="opentv-logo.svg" alt="IPTV Player" class="logo-image">
            </div>
            <div class="header-actions">
                <button id="savedUrlsBtn" class="btn btn-history" title="Hist√≥rico de URLs">
                    <span class="history-icon">üìã</span>
                    <span class="history-text">Hist√≥rico</span>
                </button>
                <button id="serverToggleBtn" class="btn btn-server" title="Modo Servidor">
                    <span>üåê</span>
                    <span id="serverStatus">Servidor</span>
                </button>
                <div class="url-input-container">
                    <input type="text" id="urlInput" placeholder="Cole a URL do M3U aqui..." class="url-input">
                </div>
                <button id="loadUrlBtn" class="btn btn-primary">
                    <span>üåê</span> Carregar URL
                </button>
            </div>
        </header>

        <!-- Modal de URLs Salvas -->
        <div id="savedUrlsModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã URLs Salvas</h2>
                    <button class="modal-close" id="closeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="savedUrlsList" class="saved-urls-list">
                        <div class="empty-state">
                            <p>Nenhuma URL salva ainda</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal do Servidor -->
        <div id="serverModal" class="modal" style="display: none;">
            <div class="modal-content server-modal">
                <div class="modal-header">
                    <h2>üåê Modo Servidor</h2>
                    <button class="modal-close" id="closeServerModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="server-status-container">
                        <div id="serverStatusInfo" class="server-status-info">
                            <div class="server-status-badge" id="serverBadge">
                                <span class="status-dot"></span>
                                <span id="statusText">Desativado</span>
                            </div>
                            <p class="server-description">Compartilhe seus canais na rede local. Qualquer dispositivo poder√° acessar via navegador.</p>
                        </div>

                        <div id="serverInfo" class="server-info" style="display: none;">
                            <div class="info-card">
                                <div class="info-label">Endere√ßo de Acesso:</div>
                                <div class="info-value">
                                    <input type="text" id="serverUrl" readonly class="server-url-input">
                                    <button class="btn btn-copy" onclick="copyServerUrl()" title="Copiar URL">
                                        üìã
                                    </button>
                                </div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">IP Local:</div>
                                <div class="info-value" id="serverIp">-</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">Porta:</div>
                                <div class="info-value" id="serverPort">2323</div>
                            </div>
                            <div class="server-qr">
                                <p>üì± Escaneie o QR Code ou digite o endere√ßo no navegador</p>
                            </div>
                        </div>

                        <div class="server-actions">
                            <button id="toggleServerBtn" class="btn btn-large btn-primary">
                                Ativar Servidor
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Chromecast -->
        <div id="castModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üì∫ Transmitir para Chromecast</h2>
                    <button class="modal-close" id="closeCastModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="cast-status-container">
                        <div id="castStatusInfo" class="cast-status-info">
                            <div class="cast-status-badge" id="castBadge">
                                <span class="status-dot"></span>
                                <span id="castStatusText">Procurando dispositivos...</span>
                            </div>
                        </div>

                        <div id="devicesContainer" class="devices-container">
                            <div id="devicesList" class="devices-list">
                                <div class="loading-devices">
                                    <div class="spinner-small"></div>
                                    <p>Buscando dispositivos Chromecast na rede...</p>
                                </div>
                            </div>
                        </div>

                        <div id="castControls" class="cast-controls" style="display: none;">
                            <div class="cast-info-card">
                                <div class="cast-label">Dispositivo Conectado:</div>
                                <div class="cast-value" id="connectedDevice">-</div>
                            </div>
                            <div class="cast-info-card">
                                <div class="cast-label">Canal Atual:</div>
                                <div class="cast-value" id="castingChannel">-</div>
                            </div>
                            <div class="cast-actions">
                                <button id="stopCastBtn" class="btn btn-danger">
                                    üõë Parar Transmiss√£o
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Sidebar com lista de canais -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="all">
                            Todos (<span id="allCount">0</span>)
                        </button>
                        <button class="tab-btn" data-tab="favorites">
                            ‚≠ê Favoritos (<span id="favCount">0</span>)
                        </button>
                    </div>
                    <div class="favorites-actions" id="favoritesActions" style="display: none;">
                        <button id="exportFavoritesBtn" class="btn-small btn-export" title="Exportar favoritos">
                            <span>üì§</span> Exportar
                        </button>
                        <button id="importFavoritesBtn" class="btn-small btn-import" title="Importar favoritos">
                            <span>üì•</span> Importar
                        </button>
                    </div>
                    <input type="text" id="searchInput" placeholder="üîç Buscar canal..." class="search-input">
                </div>
                
                <div class="channels-list" id="channelsList">
                    <div class="empty-state">
                        <p>üì∫ Nenhum canal carregado</p>
                        <p class="empty-hint">Clique em "Carregar M3U" ou cole uma URL para come√ßar</p>
                    </div>
                </div>
            </aside>

            <!-- Player principal -->
            <main class="player-container">
                <div class="player-wrapper">
                    <video id="videoPlayer" controls autoplay></video>
                    <div class="player-overlay" id="playerOverlay">
                        <div class="overlay-content">
                            <h2>Bem-vindo ao IPTV Player</h2>
                            <p>Selecione um canal para come√ßar a assistir</p>
                        </div>
                    </div>
                    <div class="loading-indicator" id="loadingIndicator">
                        <div class="spinner"></div>
                        <p>Carregando stream...</p>
                    </div>
                    <div class="error-indicator" id="errorIndicator">
                        <div class="error-content">
                            <span class="error-icon">‚ö†Ô∏è</span>
                            <h3>Erro ao carregar stream</h3>
                            <p id="errorMessage">N√£o foi poss√≠vel carregar o canal.</p>
                            <button id="retryBtn" class="btn btn-primary">Tentar Novamente</button>
                        </div>
                    </div>
                </div>

                <!-- Info do canal atual -->
                <div class="current-channel-info" id="currentChannelInfo" style="display: none;">
                    <div class="channel-details">
                        <h3 id="currentChannelName">-</h3>
                        <p id="currentChannelGroup">-</p>
                    </div>
                    <div class="channel-actions">
                        <button id="castBtn" class="btn-cast" title="Transmitir para Chromecast" style="display: none;">
                            <span id="castIcon">üì∫</span>
                        </button>
                        <button id="toggleFavoriteBtn" class="btn-favorite">
                            <span id="favoriteIcon">‚òÜ</span>
                        </button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="node_modules/hls.js/dist/hls.min.js"></script>
    <script src="renderer.js"></script>
</body>
</html>
